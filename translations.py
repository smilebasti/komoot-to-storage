# translations.py - i18n for Komoot to Storage

TRANSLATIONS = {
    'en': {
        'lang': 'en',
        'lang_name': 'English',
        'flag': 'ðŸ‡¬ðŸ‡§',
        'title': 'Komoot to Storage - Backup your tours',
        'hero_title': 'Komoot to Storage',
        'hero_subtitle': 'Export your Komoot tours as GPX files and store them safely on your own storage â€“ S3, NAS or local path.',
        'cta_export': 'Export now',
        'cta_start': 'Start export',
        'how_it_works': 'How it works',
        'step1_title': '1. Login',
        'step1_desc': 'Sign in with your Komoot credentials',
        'step2_title': '2. Filter',
        'step2_desc': 'Select date range and sport type',
        'step3_title': '3. Storage',
        'step3_desc': 'Choose S3, NFS or SMB',
        'step4_title': '4. Done!',
        'step4_desc': 'GPX files are saved',
        # Storage types
        'supported_storage': 'Supported Storage',
        's3_title': 'S3 Storage',
        's3_desc': 'AWS S3, MinIO, Backblaze B2, Wasabi and other S3-compatible services',
        'nfs_title': 'NFS / Local',
        'nfs_desc': 'Local directories or mounted network paths',
        'smb_title': 'SMB / CIFS',
        'smb_desc': 'Windows Shares, Synology, QNAP and other NAS systems',
        'selfhosted_planned': 'Self-Hosted â€¢ Planned',
        # Planned features
        'planned': 'Planned',
        'planned_features': 'Planned Features',
        'planned_features_desc': 'We are constantly working on new features',
        'webdav_title': 'WebDAV Support',
        'webdav_desc': 'Direct connection to Nextcloud, ownCloud and other WebDAV servers',
        'auto_export_title': 'Automatic Exports',
        'auto_export_desc': 'Scheduled backups via cron â€“ daily, weekly or monthly',
        'email_title': 'Email Notification',
        'email_desc': 'Receive an email when your export is complete',
        'map_title': 'Map Preview',
        'map_desc': 'View your tours on a map before exporting',
        'ready_to_export': 'Ready to export?',
        # Developer section
        'for_developers': 'For Developers',
        'developer_desc': 'Integrate Komoot exports into your own workflows',
        'api_documentation': 'API Documentation',
        'code_on_github': 'Code on GitHub',
        # Footer
        'footer_tagline': 'Open Source â€¢ Free â€¢ Your data stays with you',
        # Export page
        'back_to_home': 'Back to homepage',
        'how_it_works_short': "Here's how it works:",
        'how_it_works_desc': 'Sign in with your Komoot credentials, select a date range and storage location â€” your tours will be automatically exported as GPX files and saved securely.',
        'export_settings': 'Export Settings',
        'start_date': 'Start Date',
        'end_date': 'End Date',
        'sport_type': 'Sport Type',
        'sport_all': 'All',
        'sport_hiking': 'Hiking',
        'sport_running': 'Running',
        'sport_cycling': 'Cycling',
        'sport_mtb': 'Mountain Bike',
        'sport_racebike': 'Road Bike',
        'export_name': 'Export Name (Folder)',
        'export_name_placeholder': 'e.g. komoot-backup-2026',
        'complete_only': 'Export only completed tours',
        'komoot_credentials': 'Komoot Credentials',
        'email': 'Email',
        'password': 'Password',
        'storage_location': 'Storage Location',
        'network_path': 'Network Path',
        'endpoint_url': 'Endpoint URL',
        'bucket_name': 'Bucket Name',
        'access_key': 'Access Key',
        'secret_key': 'Secret Key',
        'path': 'Path',
        'path_hint': 'The path must exist on the server and be writable.',
        'server': 'Server',
        'share_name': 'Share Name',
        'username': 'Username',
        'subfolder': 'Subfolder (optional)',
        'start_export': 'Start Export',
        'exporting': 'Exporting...',
        'connecting': 'Connecting to Komoot and exporting tours... This may take a moment.',
        'error': 'Error',
        'unexpected_error': 'An unexpected error occurred',
        'privacy_note': 'Your credentials are only used for the export and are not stored.',
        # Progress indicator
        'progress_hint': 'Large exports with many tours may take several minutes.',
        'progress_step1': 'Connecting to Komoot...',
        'progress_step2': 'Fetching your tours...',
        'progress_step3': 'Generating GPX files...',
        'progress_step4': 'Uploading to storage...',
        'progress_done': 'Export completed!',
        # API Documentation
        'api_title': 'API Documentation',
        'rate_limit_title': 'Rate Limit',
        'api_export_desc': 'Export Komoot tours to your storage. Submit a JSON body with your credentials, date range, and storage configuration.',
        'request_body': 'Request Body',
        'parameter': 'Parameter',
        'type': 'Type',
        'required': 'Required',
        'description': 'Description',
        'yes': 'Yes',
        'no': 'No',
        'api_key_desc': 'Komoot credentials in format email:password',
        'start_date_desc': 'Start date (YYYY-MM-DD)',
        'end_date_desc': 'End date (YYYY-MM-DD)',
        'storage_type_desc': 's3, smb, or nfs',
        'export_name_desc': 'Folder name for exported files',
        'exercise_type_desc': 'Filter by sport: hiking, running, cycling, mtb, racebike',
        'complete_only_desc': 'Only export completed tours (default: false)',
        'storage_params': 'Storage Parameters',
        'local': 'Local',
        's3_endpoint_desc': 'S3 endpoint URL (e.g. https://s3.eu-central-1.amazonaws.com)',
        's3_bucket_desc': 'S3 bucket name',
        's3_access_key_desc': 'S3 access key ID',
        's3_secret_key_desc': 'S3 secret access key',
        'smb_server_desc': 'SMB server hostname or IP',
        'smb_share_desc': 'SMB share name',
        'smb_username_desc': 'SMB username',
        'smb_password_desc': 'SMB password',
        'smb_path_desc': 'Subfolder path (optional)',
        'nfs_path_desc': 'Local/NFS path (must exist and be writable)',
        'example_request': 'Example Request',
        'example_response': 'Example Response',
        'health_desc': 'Health check endpoint. Returns the service status and version.',
        'error_responses': 'Error Responses',
        'status_code': 'Status Code',
        'error_400': 'Bad Request - Missing required fields or invalid JSON',
        'error_429': 'Too Many Requests - Rate limit exceeded',
        'error_500': 'Internal Server Error - Export failed (check message for details)',
    },
    'de': {
        'lang': 'de',
        'lang_name': 'Deutsch',
        'flag': 'ðŸ‡©ðŸ‡ª',
        'title': 'Komoot to Storage - Sichere deine Touren',
        'hero_title': 'Komoot to Storage',
        'hero_subtitle': 'Exportiere deine Komoot-Touren als GPX-Dateien und speichere sie sicher auf deinem eigenen Storage â€“ S3, NAS oder lokaler Pfad.',
        'cta_export': 'Jetzt exportieren',
        'cta_start': 'Export starten',
        'how_it_works': "So funktioniert's",
        'step1_title': '1. Anmelden',
        'step1_desc': 'Mit deinen Komoot-Zugangsdaten einloggen',
        'step2_title': '2. Filtern',
        'step2_desc': 'Zeitraum und Sportart auswÃ¤hlen',
        'step3_title': '3. Speicherort',
        'step3_desc': 'S3, NFS oder SMB wÃ¤hlen',
        'step4_title': '4. Fertig!',
        'step4_desc': 'GPX-Dateien werden gespeichert',
        # Storage types
        'supported_storage': 'UnterstÃ¼tzte Speicherorte',
        's3_title': 'S3 Storage',
        's3_desc': 'AWS S3, MinIO, Backblaze B2, Wasabi und andere S3-kompatible Dienste',
        'nfs_title': 'NFS / Lokal',
        'nfs_desc': 'Lokale Verzeichnisse oder gemountete Netzwerk-Pfade',
        'smb_title': 'SMB / CIFS',
        'smb_desc': 'Windows Shares, Synology, QNAP und andere NAS-Systeme',
        'selfhosted_planned': 'Self-Hosted â€¢ Geplant',
        # Planned features
        'planned': 'Geplant',
        'planned_features': 'Geplante Features',
        'planned_features_desc': 'Wir arbeiten stÃ¤ndig an neuen Funktionen',
        'webdav_title': 'WebDAV-Support',
        'webdav_desc': 'Direkte Anbindung an Nextcloud, ownCloud und andere WebDAV-Server',
        'auto_export_title': 'Automatische Exports',
        'auto_export_desc': 'Zeitgesteuerte Backups via Cron â€“ tÃ¤glich, wÃ¶chentlich oder monatlich',
        'email_title': 'E-Mail-Benachrichtigung',
        'email_desc': 'Erhalte eine E-Mail wenn dein Export abgeschlossen ist',
        'map_title': 'Karten-Vorschau',
        'map_desc': 'Sieh deine Touren auf einer Karte bevor du exportierst',
        'ready_to_export': 'Bereit zum Exportieren?',
        # Developer section
        'for_developers': 'FÃ¼r Entwickler',
        'developer_desc': 'Integriere Komoot-Exports in deine eigenen Workflows',
        'api_documentation': 'API-Dokumentation',
        'code_on_github': 'Code auf GitHub',
        # Footer
        'footer_tagline': 'Open Source â€¢ Kostenlos â€¢ Deine Daten bleiben bei dir',
        # Export page
        'back_to_home': 'ZurÃ¼ck zur Startseite',
        'how_it_works_short': "So funktioniert's:",
        'how_it_works_desc': 'Melde dich mit deinen Komoot-Zugangsdaten an, wÃ¤hle einen Zeitraum und Speicherort â€” deine Touren werden automatisch als GPX-Dateien exportiert und sicher gespeichert.',
        'export_settings': 'Export-Einstellungen',
        'start_date': 'Startdatum',
        'end_date': 'Enddatum',
        'sport_type': 'Sportart',
        'sport_all': 'Alle',
        'sport_hiking': 'Wandern',
        'sport_running': 'Laufen',
        'sport_cycling': 'Radfahren',
        'sport_mtb': 'Mountainbike',
        'sport_racebike': 'Rennrad',
        'export_name': 'Export-Name (Ordner)',
        'export_name_placeholder': 'z.B. komoot-backup-2026',
        'complete_only': 'Nur abgeschlossene Touren exportieren',
        'komoot_credentials': 'Komoot-Zugangsdaten',
        'email': 'E-Mail',
        'password': 'Passwort',
        'storage_location': 'Speicherort',
        'network_path': 'Netzwerk-Pfad',
        'endpoint_url': 'Endpoint URL',
        'bucket_name': 'Bucket Name',
        'access_key': 'Access Key',
        'secret_key': 'Secret Key',
        'path': 'Pfad',
        'path_hint': 'Der Pfad muss auf dem Server existieren und beschreibbar sein.',
        'server': 'Server',
        'share_name': 'Share Name',
        'username': 'Benutzername',
        'subfolder': 'Unterordner (optional)',
        'start_export': 'Export starten',
        'exporting': 'Exportiere...',
        'connecting': 'Verbinde mit Komoot und exportiere Touren... Dies kann einen Moment dauern.',
        'error': 'Fehler',
        'unexpected_error': 'Ein unerwarteter Fehler ist aufgetreten',
        'privacy_note': 'Deine Zugangsdaten werden nur fÃ¼r den Export verwendet und nicht gespeichert.',
        # Progress indicator
        'progress_hint': 'GroÃŸe Exports mit vielen Touren kÃ¶nnen mehrere Minuten dauern.',
        'progress_step1': 'Verbinde mit Komoot...',
        'progress_step2': 'Lade deine Touren...',
        'progress_step3': 'Generiere GPX-Dateien...',
        'progress_step4': 'Lade auf Storage hoch...',
        'progress_done': 'Export abgeschlossen!',
        # API Documentation
        'api_title': 'API-Dokumentation',
        'rate_limit_title': 'Rate Limit',
        'api_export_desc': 'Exportiere Komoot-Touren auf deinen Speicher. Sende einen JSON-Body mit deinen Zugangsdaten, Zeitraum und Speicherkonfiguration.',
        'request_body': 'Request Body',
        'parameter': 'Parameter',
        'type': 'Typ',
        'required': 'Erforderlich',
        'description': 'Beschreibung',
        'yes': 'Ja',
        'no': 'Nein',
        'api_key_desc': 'Komoot-Zugangsdaten im Format email:passwort',
        'start_date_desc': 'Startdatum (YYYY-MM-DD)',
        'end_date_desc': 'Enddatum (YYYY-MM-DD)',
        'storage_type_desc': 's3, smb oder nfs',
        'export_name_desc': 'Ordnername fÃ¼r exportierte Dateien',
        'exercise_type_desc': 'Nach Sportart filtern: hiking, running, cycling, mtb, racebike',
        'complete_only_desc': 'Nur abgeschlossene Touren exportieren (Standard: false)',
        'storage_params': 'Speicher-Parameter',
        'local': 'Lokal',
        's3_endpoint_desc': 'S3 Endpoint URL (z.B. https://s3.eu-central-1.amazonaws.com)',
        's3_bucket_desc': 'S3 Bucket Name',
        's3_access_key_desc': 'S3 Access Key ID',
        's3_secret_key_desc': 'S3 Secret Access Key',
        'smb_server_desc': 'SMB Server Hostname oder IP',
        'smb_share_desc': 'SMB Share Name',
        'smb_username_desc': 'SMB Benutzername',
        'smb_password_desc': 'SMB Passwort',
        'smb_path_desc': 'Unterordner-Pfad (optional)',
        'nfs_path_desc': 'Lokaler/NFS-Pfad (muss existieren und beschreibbar sein)',
        'example_request': 'Beispiel-Request',
        'example_response': 'Beispiel-Response',
        'health_desc': 'Health-Check Endpoint. Gibt den Service-Status und die Version zurÃ¼ck.',
        'error_responses': 'Fehler-Responses',
        'status_code': 'Status Code',
        'error_400': 'Bad Request - Fehlende Pflichtfelder oder ungÃ¼ltiges JSON',
        'error_429': 'Too Many Requests - Rate Limit Ã¼berschritten',
        'error_500': 'Internal Server Error - Export fehlgeschlagen (Details in der Nachricht)',
    }
}

def get_translations(lang_code):
    return TRANSLATIONS.get(lang_code, TRANSLATIONS['en'])

def detect_language(request):
    lang = request.args.get('lang')
    if lang in TRANSLATIONS:
        return lang
    lang = request.cookies.get('lang')
    if lang in TRANSLATIONS:
        return lang
    accept_lang = request.headers.get('Accept-Language', '')
    if accept_lang:
        for part in accept_lang.split(','):
            lang_part = part.split(';')[0].strip().lower()
            if lang_part[:2] == 'de':
                return 'de'
    return 'en'
